codetasty.revision.2.0
{"ts":1524673484,"restoring":false,"user_id":7359,"patch":[{"diffs":[[1,"<?php\r\nif(!isset($_SESSION)){\r\n\tsession_start();\r\n}\r\nif(!isset($_SESSION['username'])){\r\n\theader(\"location: /db/login.php\");\r\n}\r\n?>\r\n<?php $thisPage=\"dbs\"; ?>\r\n\r\n    <!DOCTYPE html>\r\n\r\n    <html lang=\"en\">\r\n\r\n    <head>\r\n\r\n        <title>Cedar High School</title>\r\n\r\n        <?php include(\"../assets/inc/headtag.php\");\r\n        $manage->require_perm(\"edit\");\r\n        ?>\r\n    </head>\r\n\r\n    <body>\r\n\r\n         <?php include(\"../assets/inc/navbar.php\") ?>\r\n\r\n            <!-- Let the container begin! -->\r\n\r\n\t\t\t<div class=\"container\">\r\n\t\t\t\t<div class=\"row\">\r\n\r\n\t\t\t\t\t<?php include(\"../assets/inc/navlist.php\") ?>\r\n\t\t\t\t\t<?php mustLogIn(); ?>\r\n\t\t\t\t\t<script>\r\n\t\t\t\t\t$(function() {\r\n\t\t\t\t\t\t$(\".btn-save\").click(function() {\r\n\t\t\t\t\t\t\tvar obid = $(this);\r\n\t\t\t\t\t\t\t$.post(\"/db/savevar.php\", { name: obid.data(\"var\"), value: $(\"#\"+obid.data(\"var\")).val() })\r\n\t\t\t\t\t\t  .done(function( stuff ) {\r\n\t\t\t\t\t\t  \tconsole.log(stuff);\r\n\t\t\t\t\t\t  \tif(stuff == \"true\"){\r\n\t\t\t\t\t\t\t\t\t$(\"#\"+obid.data(\"var\")+\"_tt\").text(\"Saved!\");\r\n\t\t\t\t\t\t\t\t\t$(\"#\"+obid.data(\"var\")+\"_te\").text(\"\");\r\n\t\t\t\t\t\t\t\t\tvar it = obid;\r\n\t\t\t\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t\t\t\t$(\"#\"+it.data(\"var\")+\"_tt\").text(\"\");\r\n\t\t\t\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t\t  \t}else{\r\n\t\t\t\t\t\t  \t\t$(\"#\"+obid.data(\"var\")+\"_te\").text(\"Error! \"+stuff);\r\n\t\t\t\t\t\t  \t}\r\n\t\t\t\t\t\t  });\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t$(\".btn-copy\").click(function() {\r\n\t\t\t\t\t\t\tprompt(\"Copy this to use in code:\",\"\\<\\?\\=\\$vars\\[\\'\"+$(this).data(\"var\")+\"\\'\\]\\?\\>\");\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\t</script>\r\n\t\t\t\t\t<span class=\"span9\">\r\n\r\n\t\t\t\t\t\t<div class=\"row-fluid\">\r\n\r\n\t\t\t\t\t\t\t<div class=\"well\">\r\n\t\t\t\t\t\t\t\t<h1><i class=\"fa fa-microchip\"></i> Variables</h1>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"well\">\r\n\t\t\t\t\t\t\t\t<?php\r\n\t\t\t\t\t\t\t\tif($cuser['edit'] != 1){\r\n\t\t\t\t\t\t\t\t\tdie(\"<div class=\\\"alert alert-danger\\\"><b>Sorry!</b> You do not have permission to do this!</div>\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// $conn = new mysqli(\"205.125.0.100\", \"chscyberweb\", $pwwd, \"chs\");\r\n\t\t\t\t\t\t\t\t$conn = $manage->database();\r\n\t\t\t\t\t\t\t\t// Check connection\r\n\t\t\t\t\t\t\t\tif ($conn->connect_error) {\r\n\t\t\t\t\t\t\t\t\tdie(\"<div class=\\\"alert alert-danger\\\"><b>Connection failed</b><br> \" . $conn->connect_error . \"</div>\");\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\techo \"<div class=\\\"alert alert-success\\\">Connected</div>\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t$varlist = $conn->query(\"select * from variables\");\r\n\t\t\t\t\t\t\t\twhile($item = $varlist->fetch_array()){\r\n\t\t\t\t\t\t\t\t\t?>\r\n\t\t\t\t\t\t\t\t\t<form class=\"form-horizontal\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"control-group\">\r\n\t\t\t\t\t\t\t\t\t    <label class=\"control-label\" for=\"<?=$item['name']?>\"><?=$item['friendly_name']?></label>\r\n\t\t\t\t\t\t\t\t\t    <div class=\"controls\">\r\n\t\t\t\t\t\t\t\t\t      <input type=\"text\" id=\"<?=$item['name']?>\" data-var=\"<?=$item['name']?>\" placeholder=\"value for <?=$item['name']?>\" value=\"<?=$item['value']?>\">\r\n\t\t\t\t\t\t\t\t\t      <?php if($cuser['coder'] == 1){ ?>\r\n\t\t\t\t\t\t\t\t\t      <button type=\"submit\" class=\"btn btn-primary btn-copy\" id=\"<?=$item['name']?>_copy\" data-var=\"<?=$item['name']?>\"><i class=\"fa fa-copy\"></i></button>&nbsp;\r\n\t\t\t\t\t\t\t\t\t      <?php } ?>\r\n\t\t\t\t\t\t\t\t\t      <button type=\"submit\" class=\"btn btn-success btn-save\" id=\"<?=$item['name']?>_save\" data-var=\"<?=$item['name']?>\"><i class=\"fa fa-save\"></i></button>&nbsp;\r\n\t\t\t\t\t\t\t\t\t      <span style=\"color: green;\" id=\"<?=$item['name']?>_tt\" data-var=\"<?=$item['name']?>\"></span>&nbsp;\r\n\t\t\t\t\t\t\t\t\t      <span style=\"color: red;\" id=\"<?=$item['name']?>_te\" data-var=\"<?=$item['name']?>\"></span>\r\n\t\t\t\t\t\t\t\t\t    </div>\r\n\t\t\t\t\t\t\t\t\t  </div>\r\n\t\t\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t\t\t\t<?php\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t?>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<!--/row-fluid -->\r\n\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<!--/span6 -->\r\n\t\t\t\t\t<?php $conn->close(); ?>\r\n\t\t\t\t</div>\r\n\t\t\t\t<!--/row -->\r\n\r\n\t\t\t\t<?php include(\"assets/inc/footer.php\") ?>\r\n\r\n\t\t\t</div>\r\n                <!-- /container -->\r\n\r\n                <!-- Placed at the end of the document so the pages load faster -->\r\n\r\n                <script src=\"//chs.ironk12.org/assets/js/jquery.js\"></script>\r\n\r\n                <script src=\"//chs.ironk12.org/assets/js/bootstrap.js\"></script>\r\n    </body>\r\n\r\n    </html>"]],"start1":0,"start2":0,"length1":0,"length2":4040}],"length":4040}